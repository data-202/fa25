{
  "hash": "d5689093b655d69c423a45348c386f1e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"DATA 202 - Analyzing Multiple Variables\"\nauthor: \"FirstName LastName\"\noutput: html_document\neditor_options:\n    chunk_output_type: console\n---\n\n\n\n\n\n\n\nThere are multiple options when conducting the analysis of multiple variables (i.e., more than two variables). In this file, I provide some very basic code to help you get started on your analysis for your paper on analyzing the relationship between multiple variables.\n\n# Libraries and packages\n\nLoad the libraries we needed. Be sure to `install.packages()` where needed.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# again, remember to install necessary packages first\n#install.packages(\"mvnormtest)\n\n# load libraries\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(corrplot)\nlibrary(car)\nlibrary(lmtest)\nlibrary(mvnormtest)\nlibrary(ggpubr)  # combined plots\nlibrary(vcd)     # mosaic plots\n```\n:::\n\n\n\n\n\n## Load sample data from github\n\nWe'll use the gender pay gap data again that I have prepared.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npay_gap_data <- read.csv(\"https://raw.githubusercontent.com/data-202/sp25/refs/heads/master/data/pay_data.csv\")\n```\n:::\n\n\n\n\n\n# Exploratory analysis\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# view the structure of your data\nstr(pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t100 obs. of  4 variables:\n $ gender          : chr  \"Male\" \"Female\" \"Male\" \"Female\" ...\n $ job_title       : chr  \"Data Scientist\" \"Chemist\" \"Data Scientist\" \"Data Scientist\" ...\n $ years_experience: num  19 3.4 9.9 5.6 1.4 9.9 1.6 5.6 1.4 16.8 ...\n $ annual_salary   : num  90000 45000 70000 46000 42000 84000 56000 44000 41000 74000 ...\n```\n\n\n:::\n\n```{.r .cell-code}\n# view the top and bottom of your data\nhead(pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      gender      job_title years_experience annual_salary\n1       Male Data Scientist             19.0         90000\n2     Female        Chemist              3.4         45000\n3       Male Data Scientist              9.9         70000\n4     Female Data Scientist              5.6         46000\n5 Non-binary      Biologist              1.4         42000\n6       Male        Chemist              9.9         84000\n```\n\n\n:::\n\n```{.r .cell-code}\ntail(pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    gender         job_title years_experience annual_salary\n95    Male Software Engineer             13.3         78000\n96    Male             Other             24.1        100000\n97  Female             Other             19.4         74000\n98    Male         Biologist              5.2         70000\n99    Male         Biologist              7.7         64000\n100   Male    Data Scientist             24.3        100000\n```\n\n\n:::\n\n```{.r .cell-code}\n# gather counts for your categorical data\ntable(pay_gap_data$gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n    Female       Male Non-binary \n        37         56          7 \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(pay_gap_data$job_title)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n        Biologist           Chemist    Data Scientist             Other \n               20                19                19                23 \nSoftware Engineer \n               19 \n```\n\n\n:::\n\n```{.r .cell-code}\n# gather descriptive statistics for your numeric variables\npay_gap_data %>%\n  select(years_experience, annual_salary) %>% \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n years_experience annual_salary   \n Min.   : 0.20    Min.   : 38000  \n 1st Qu.: 5.60    1st Qu.: 56750  \n Median :10.90    Median : 68500  \n Mean   :11.95    Mean   : 68820  \n 3rd Qu.:18.93    3rd Qu.: 81000  \n Max.   :25.00    Max.   :115000  \n```\n\n\n:::\n:::\n\n\n\n\n\n## Anlayzing bivariate relationships\n\nWe then want to analyze the bivariate relationship between each of the variables in our model.\n\n### Numeric-Numeric relationships\n\nWe'll start with a scatter plot to visualize the relationship between the numeric variables.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(pay_gap_data[, c(\"annual_salary\", \"years_experience\")],\n      main = \"Pairwise Scatterplot Matrix\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pay_gap_data, aes(x = years_experience, y = annual_salary)) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"lm\", color = \"red\") +\n  labs(title = \"Experience vs Salary Relationship\",\n       x = \"Years of Experience\", y = \"Annual Salary\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# check correlation value\ncor.test(pay_gap_data$annual_salary, pay_gap_data$years_experience)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  pay_gap_data$annual_salary and pay_gap_data$years_experience\nt = 15.413, df = 98, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.7726828 0.8906291\nsample estimates:\n      cor \n0.8414022 \n```\n\n\n:::\n:::\n\n\n\n\n\n### Categorical-Numeric relationships\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Gender vs Salary\nggplot(pay_gap_data, aes(x = gender, \n                         y = annual_salary, \n                         fill = gender)) +\n  geom_boxplot() +\n  labs(title = \"Salary Distribution by Gender\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Job Title vs Salary (sorted by median salary)\npay_gap_data %>%\n  mutate(job_title = reorder(job_title, annual_salary, median)) %>%\n  ggplot(aes(x = job_title, y = annual_salary, fill = job_title)) +\n  geom_boxplot() +\n  coord_flip() +  # Better readability for long job titles\n  labs(title = \"Salary Distribution by Job Title\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Job Title vs Experience\npay_gap_data %>%\n  mutate(job_title = reorder(job_title, years_experience, median)) %>%\n  ggplot(aes(x = job_title, y = years_experience, fill = job_title)) +\n  geom_boxplot() +\n  coord_flip() +\n  labs(title = \"Experience Distribution by Job Title\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Categorical-Categorical relationship\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# bar chart of the categorical relationships\nggplot(pay_gap_data, aes(x = job_title, fill = gender)) +\n  geom_bar(position = \"dodge\") +\n  coord_flip() +\n  labs(title = \"Gender Distribution Across Job Titles\",\n       x = \"Job Title\", y = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.y = element_text(angle = 0, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n\nWe can then conduct a chi-square test to see if there is a relation.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Chi-square test\nchisq.test(pay_gap_data$gender, pay_gap_data$job_title)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  pay_gap_data$gender and pay_gap_data$job_title\nX-squared = 10.259, df = 8, p-value = 0.2473\n```\n\n\n:::\n:::\n\n\n\n\n\n## Visualizing the combined relationships\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Salary ~ Experience faceted by Gender\nggplot(pay_gap_data, aes(x = years_experience, y = annual_salary)) +\n  geom_point(aes(color = gender)) +\n  geom_smooth(method = \"lm\") +\n  facet_wrap(~gender) +\n  labs(title = \"Experience-Salary Relationship by Gender\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Salary ~ Experience colored by Job Title\nggplot(pay_gap_data, aes(x = years_experience, y = annual_salary, color = job_title)) +\n  geom_point(alpha = 0.7) +\n  labs(title = \"Experience-Salary Relationship by Job Title\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\n\n------------------------------------------------------------------------\n\n# Multiple Variable Analysis\n\nMultiple variable analysis is a statistical technique that examines relationships between three or more variables simultaneously. The multiple variable analysis technique involves analyzing how multiple independent variables relate to one or more dependent variables, aiming to understand the interdependence of these variables and their impact on each other.\n\n## Research questions\n\nRQ1: Does gender, job title, and years of experience significantly impact an individual's annual salary?\n\nRQ2: How much variance in salary can be explained by gender and job title after controlling for years of experience?\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"grViz html-widget html-fill-item\" id=\"htmlwidget-9134e9ad8da711d23629\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9134e9ad8da711d23629\">{\"x\":{\"diagram\":\"\\ndigraph relationships {\\n  graph [layout = dot, rankdir = LR]\\n\\n  # Define nodes\\n  node [shape = ellipse, style = filled]\\n  X1 [label = \\\"gender (X1)\\\", color = lightblue]\\n  X2 [label = \\\"job title (X2)\\\", color = lightblue]\\n  X3 [label = \\\"experience (X3)\\\", color = lightblue]\\n  Y [label = \\\"annual salary (Y)\\\", fillcolor = lightblue, fontcolor = black]\\n\\n  # Define edges (relationships)\\n  X1 -> Y\\n  X2 -> Y\\n  X3 -> Y\\n}\\n\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n\n## Base statistical models\n\nBelow, I provide the base statistical models to answer the listed research questions. However, be reminded that you should utilize your theoretical framework to drive your analysis. The most important component of our modeling here are the post-hoc tests of our assumptions.\n\n### Research Question 1\n\nRQ1: Does gender, job title, and years of experience significantly impact an individual's annual salary?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the model\nmodel <- lm(annual_salary ~ gender + job_title + years_experience, data = pay_gap_data)\n\n# Get the summary of the model\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = annual_salary ~ gender + job_title + years_experience, \n    data = pay_gap_data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-13703  -3632   -128   2751  19370 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                36711.50    1968.85  18.646  < 2e-16 ***\ngenderMale                 13964.08    1411.79   9.891 3.87e-16 ***\ngenderNon-binary            7665.83    2841.64   2.698  0.00831 ** \njob_titleChemist              -5.78    2140.76  -0.003  0.99785    \njob_titleData Scientist      -47.80    2148.50  -0.022  0.98230    \njob_titleOther              4453.30    2029.46   2.194  0.03073 *  \njob_titleSoftware Engineer   622.90    2142.47   0.291  0.77191    \nyears_experience            1893.49      89.47  21.165  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6617 on 92 degrees of freedom\nMultiple R-squared:  0.8623,\tAdjusted R-squared:  0.8519 \nF-statistic: 82.33 on 7 and 92 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Checking Assumptions\n\nWe then want to check the assumptions for our multiple linear regression model.\n\nWe use the `which` command here to call for specific results.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Linearity and homoscedasticity\nplot(model, which = 1)\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Normality of residuals\nplot(model, which = 2)\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Influential points\nplot(model, which = 4)\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Multicollinearity\nvif(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     GVIF Df GVIF^(1/(2*Df))\ngender           1.118704  2        1.028440\njob_title        1.121275  4        1.014411\nyears_experience 1.014016  1        1.006983\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Heteroscedasticity test\nbptest(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  model\nBP = 8.3223, df = 7, p-value = 0.305\n```\n\n\n:::\n:::\n\n\n\n\n\n### Research Question 2\n\nRQ2: How much variance in salary can be explained by gender and job title after controlling for years of experience?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract R-squared values\nr_squared_full <- model$r.squared\n\nr_squared_experience <- \n  summary(lm(annual_salary ~ years_experience, \n             data = pay_gap_data))$r.squared\n\n# Calculate the additional variance explained\nvariance.model <- r_squared_full - r_squared_experience\nvariance.model\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nnumeric(0)\n```\n\n\n:::\n:::\n\n\n\n\n\n### Additional tests to examine differences by groupings\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## ANOVA: Job Title vs Salary\nsummary(aov(annual_salary ~ job_title, data = pay_gap_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df    Sum Sq   Mean Sq F value Pr(>F)\njob_title    4 2.704e+08  67594834   0.221  0.926\nResiduals   95 2.900e+10 305225060               \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Kruskal-Wallis test (a non-parametric alternative)\nkruskal.test(annual_salary ~ job_title, data = pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  annual_salary by job_title\nKruskal-Wallis chi-squared = 0.87467, df = 4, p-value = 0.9282\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## ANOVA for Gender Differences (3 groups)\n# For normally distributed data\ngender_salary_aov <- aov(annual_salary ~ gender, data = pay_gap_data)\nsummary(gender_salary_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df    Sum Sq   Mean Sq F value   Pr(>F)    \ngender       2 5.462e+09 2.731e+09   11.13 4.46e-05 ***\nResiduals   97 2.380e+10 2.454e+08                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\ngender_experience_aov <- aov(years_experience ~ gender, data = pay_gap_data)\nsummary(gender_experience_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\ngender       2     37   18.58   0.327  0.722\nResiduals   97   5511   56.81               \n```\n\n\n:::\n\n```{.r .cell-code}\n## Post-hoc pairwise comparisons (if ANOVA is significant)\n# Tukey's Honest Significant Differences\nTukeyHSD(gender_salary_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = annual_salary ~ gender, data = pay_gap_data)\n\n$gender\n                      diff        lwr       upr     p adj\nMale-Female        15511.1   7611.431 23410.770 0.0000283\nNon-binary-Female   5386.1  -9982.659 20754.859 0.6827936\nNon-binary-Male   -10125.0 -25073.224  4823.224 0.2453817\n```\n\n\n:::\n\n```{.r .cell-code}\nTukeyHSD(gender_experience_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = years_experience ~ gender, data = pay_gap_data)\n\n$gender\n                        diff       lwr      upr     p adj\nMale-Female        0.9510135 -2.849798 4.751825 0.8228241\nNon-binary-Female -1.0436293 -8.438085 6.350827 0.9397284\nNon-binary-Male   -1.9946429 -9.186764 5.197479 0.7870735\n```\n\n\n:::\n\n```{.r .cell-code}\n## Non-parametric alternative (Kruskal-Wallis)\nkruskal.test(annual_salary ~ gender, data = pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  annual_salary by gender\nKruskal-Wallis chi-squared = 17.035, df = 2, p-value = 2e-04\n```\n\n\n:::\n\n```{.r .cell-code}\nkruskal.test(years_experience ~ gender, data = pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  years_experience by gender\nKruskal-Wallis chi-squared = 0.69574, df = 2, p-value = 0.7062\n```\n\n\n:::\n\n```{.r .cell-code}\n## Pairwise Wilcoxon Rank Sum tests with Bonferroni correction\npairwise.wilcox.test(pay_gap_data$annual_salary, pay_gap_data$gender,\n                     p.adjust.method = \"bonferroni\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  pay_gap_data$annual_salary and pay_gap_data$gender \n\n           Female  Male   \nMale       0.00013 -      \nNon-binary 1.00000 0.62443\n\nP value adjustment method: bonferroni \n```\n\n\n:::\n\n```{.r .cell-code}\npairwise.wilcox.test(pay_gap_data$years_experience, pay_gap_data$gender,\n                     p.adjust.method = \"bonferroni\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  pay_gap_data$years_experience and pay_gap_data$gender \n\n           Female Male\nMale       1      -   \nNon-binary 1      1   \n\nP value adjustment method: bonferroni \n```\n\n\n:::\n\n```{.r .cell-code}\n## Enhanced gender-salary plot\nggplot(pay_gap_data, aes(x = gender, y = annual_salary, fill = gender)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.2, alpha = 0.4) +\n  stat_compare_means(method = \"anova\", label.y = max(pay_gap_data$annual_salary)*1.1) +\n  labs(title = \"Salary Distribution Across Gender Groups\",\n       subtitle = \"Three-group comparison with ANOVA results\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n```{.r .cell-code}\n## Faceted experience-salary relationship\nggplot(pay_gap_data, aes(x = years_experience, y = annual_salary)) +\n  geom_point(aes(color = gender)) +\n  geom_smooth(method = \"lm\") +\n  facet_wrap(~gender, ncol = 3) +\n  labs(title = \"Experience-Salary Relationship by Gender Group\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-23-2.png){width=672}\n:::\n:::\n\n\n\n\n\n------------------------------------------------------------------------\n\n# Multivariate Analysis\n\nMultivariate analysis and multiple variable analysis are often confused, but they have a key distinction. Multivariate analysis specifically examines multiple dependent or outcome variables simultaneously, while multiple variable analysis (also called multivariable analysis) focuses on a single outcome variable with multiple independent variables.\n\n## Research question\n\nRQ1: Do gender and job title jointly influence both salary and years of experience?\n\nRQ2: Are there significant differences in salary distributions across job titles when accounting for gender and experience?\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"grViz html-widget html-fill-item\" id=\"htmlwidget-f92eb4578298bcd2505f\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f92eb4578298bcd2505f\">{\"x\":{\"diagram\":\"\\n  digraph variables_diagram {\\n    graph [rankdir = LR]\\n    \\n    node [shape = ellipse, style = filled, fillcolor = lightblue]\\n    gender [label = \\\"Gender\\\"]\\n    job_title [label = \\\"Job Title\\\"]\\n    \\n    node [shape = ellipse, style = filled, fillcolor = lightyellow]\\n    salary [label = \\\"Annual Salary\\\"]\\n    experience [label = \\\"Years of Experience\\\"]\\n    \\n    gender -> salary\\n    gender -> experience\\n    job_title -> salary\\n    job_title -> experience\\n  }\\n\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n\n### MANOVA\n\nRQ1: Do gender and job title jointly influence both salary and years of experience?\n\nTo answer RQ1, we'll first run a multiple analysis of variance (MANOVA) on our data.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmanova_result <- manova(cbind(annual_salary, years_experience) ~ gender + job_title, data = pay_gap_data)\n\nsummary(manova_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df  Pillai approx F num Df den Df    Pr(>F)    \ngender     2 0.51380  16.0756      4    186 2.532e-11 ***\njob_title  4 0.08312   1.0082      8    186    0.4313    \nResiduals 93                                             \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform univariate ANOVAs for each dependent variable\nsummary.aov(manova_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Response annual_salary :\n            Df     Sum Sq    Mean Sq F value   Pr(>F)    \ngender       2 5.4621e+09 2731054952  10.742 6.35e-05 ***\njob_title    4 1.6067e+08   40167715   0.158   0.9589    \nResiduals   93 2.3644e+10  254236336                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Response years_experience :\n            Df Sum Sq Mean Sq F value Pr(>F)\ngender       2   37.2  18.578  0.3158 0.7300\njob_title    4   39.5   9.881  0.1680 0.9542\nResiduals   93 5471.0  58.828               \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Post-hoc tests for job title (if significant)\nTukeyHSD(aov(annual_salary ~ job_title, data = pay_gap_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = annual_salary ~ job_title, data = pay_gap_data)\n\n$job_title\n                                       diff       lwr      upr     p adj\nChemist-Biologist                 2744.7368 -12819.59 18309.07 0.9880828\nData Scientist-Biologist          4902.6316 -10661.70 20466.96 0.9050536\nOther-Biologist                   3676.0870 -11177.98 18530.15 0.9585863\nSoftware Engineer-Biologist       1955.2632 -13609.07 17519.59 0.9967520\nData Scientist-Chemist            2157.8947 -13604.72 17920.50 0.9954695\nOther-Chemist                      931.3501 -14130.35 15993.05 0.9998006\nSoftware Engineer-Chemist         -789.4737 -16552.08 14973.14 0.9999138\nOther-Data Scientist             -1226.5446 -16288.24 13835.15 0.9994066\nSoftware Engineer-Data Scientist -2947.3684 -18709.98 12815.24 0.9851493\nSoftware Engineer-Other          -1720.8238 -16782.52 13340.87 0.9977552\n```\n\n\n:::\n\n```{.r .cell-code}\nTukeyHSD(aov(years_experience ~ job_title, data = pay_gap_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = years_experience ~ job_title, data = pay_gap_data)\n\n$job_title\n                                       diff       lwr      upr     p adj\nChemist-Biologist                 0.8871053 -5.890221 7.664432 0.9961911\nData Scientist-Biologist          1.6607895 -5.116537 8.438116 0.9600164\nOther-Biologist                  -0.3419565 -6.810004 6.126091 0.9998930\nSoftware Engineer-Biologist       0.4502632 -6.327063 7.227590 0.9997349\nData Scientist-Chemist            0.7736842 -6.089981 7.637350 0.9978703\nOther-Chemist                    -1.2290618 -7.787521 5.329398 0.9850252\nSoftware Engineer-Chemist        -0.4368421 -7.300507 6.426823 0.9997764\nOther-Data Scientist             -2.0027460 -8.561205 4.555713 0.9143543\nSoftware Engineer-Data Scientist -1.2105263 -8.074192 5.653139 0.9880778\nSoftware Engineer-Other           0.7922197 -5.766240 7.350679 0.9972112\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Check MANOVA assumptions\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Multivariate normality\nmshapiro.test(t(model.matrix(manova_result)[, -1]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Z\nW = 0.74976, p-value = 9.227e-12\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Homogeneity of covariance matrices\nleveneTest(annual_salary ~ gender * job_title, data = pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup 12   0.597 0.8391\n      87               \n```\n\n\n:::\n\n```{.r .cell-code}\nleveneTest(years_experience ~ gender * job_title, data = pay_gap_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup 12  0.6305 0.8108\n      87               \n```\n\n\n:::\n:::\n\n\n\n\n\n### Visual of the results\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pay_gap_data, aes(x = job_title, y = annual_salary, fill = gender)) +\n  geom_boxplot() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(title = \"Salary Distribution by Job Title and Gender\",\n       x = \"Job Title\", y = \"Annual Salary\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(pay_gap_data, aes(x = job_title, y = years_experience, fill = gender)) +\n  geom_boxplot() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(title = \"Years of Experience Distribution by Job Title and Gender\",\n       x = \"Job Title\", y = \"Years of Experience\")\n```\n\n::: {.cell-output-display}\n![](multivars_files/figure-html/unnamed-chunk-30-2.png){width=672}\n:::\n:::\n\n\n\n\n\nRQ2: Are there significant differences in salary distributions across job titles when accounting for gender and experience?\n\nTo answer research question two, we'll run some additoinal analyses.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_salary <- lm(annual_salary ~ job_title + gender + years_experience, data = pay_gap_data)\nanova(model_salary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: annual_salary\n                 Df     Sum Sq    Mean Sq  F value Pr(>F)    \njob_title         4 2.7038e+08 6.7595e+07   1.5436 0.1962    \ngender            2 5.3524e+09 2.6762e+09  61.1142 <2e-16 ***\nyears_experience  1 1.9615e+10 1.9615e+10 447.9384 <2e-16 ***\nResiduals        92 4.0287e+09 4.3790e+07                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(model_salary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = annual_salary ~ job_title + gender + years_experience, \n    data = pay_gap_data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-13703  -3632   -128   2751  19370 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                36711.50    1968.85  18.646  < 2e-16 ***\njob_titleChemist              -5.78    2140.76  -0.003  0.99785    \njob_titleData Scientist      -47.80    2148.50  -0.022  0.98230    \njob_titleOther              4453.30    2029.46   2.194  0.03073 *  \njob_titleSoftware Engineer   622.90    2142.47   0.291  0.77191    \ngenderMale                 13964.08    1411.79   9.891 3.87e-16 ***\ngenderNon-binary            7665.83    2841.64   2.698  0.00831 ** \nyears_experience            1893.49      89.47  21.165  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6617 on 92 degrees of freedom\nMultiple R-squared:  0.8623,\tAdjusted R-squared:  0.8519 \nF-statistic: 82.33 on 7 and 92 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n\nAs noted in class, these are base models to help you consider your analysis. However, your theory should lead all of your work. Please let me know if you have any questions.\n",
    "supporting": [
      "multivars_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/viz-1.8.2/viz.js\"></script>\n<link href=\"../site_libs/DiagrammeR-styles-0.2/styles.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/grViz-binding-1.0.11/grViz.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}